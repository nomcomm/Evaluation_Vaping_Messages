rm(list = ls())
library(tidyr)
library(ggplot2)
library(dplyr)
library(rstatix)
library(WebPower)
library(readr)
#power analysis for mixed ANOVA
wp.rmanova(ng = 2, nm = 2, f = 0.25, nscor = 1, alpha = 0.05, power = .8, type = 2)
setwd("/Users/suelim/Documents/Research/Evaluation_Vaping_Messages/github/Evaluation_Vaping_Messages/data/02_Data")
#creating Effects Perception (EP) and Ranking variables
sum_AI_EP <- 0
sum_Human_EP <- 0
for (i in 1:15) {
df_total[[paste0("AI", i, "_EP")]] <-
(df_total[[paste0("Dis_AI", i)]] + df_total[[paste0("Con_AI", i)]] +
df_total[[paste0("Unp_AI", i)]]) / 3
sum_AI_EP <- sum_AI_EP + df_total[[paste0("AI", i, "_EP")]]
}
df_total$AI_mean_EP <- sum_AI_EP / 15
#demographics
df_total <- read_csv('study1_data.csv')
#creating Effects Perception (EP) and Ranking variables
sum_AI_EP <- 0
sum_Human_EP <- 0
for (i in 1:15) {
df_total[[paste0("AI", i, "_EP")]] <-
(df_total[[paste0("Dis_AI", i)]] + df_total[[paste0("Con_AI", i)]] +
df_total[[paste0("Unp_AI", i)]]) / 3
sum_AI_EP <- sum_AI_EP + df_total[[paste0("AI", i, "_EP")]]
}
df_total$AI_mean_EP <- sum_AI_EP / 15
for (i in 1:15) {
df_total[[paste0("Human", i, "_EP")]] <-
(df_total[[paste0("Dis_Hum", i)]] + df_total[[paste0("Con_Hum", i)]] +
df_total[[paste0("Unp_Hum", i)]]) / 3
sum_Human_EP <- sum_Human_EP + df_total[[paste0("Human", i, "_EP")]]
}
df_total$Human_mean_EP <- sum_Human_EP / 15
sum_Ranking_AI <- 0
sum_Ranking_Human <- 0
for (i in 1:15) {
sum_Ranking_AI <- sum_Ranking_AI + df_total[[paste0("Ranking_AI", i)]]
}
df_total$AI_MSG_Rank_mean <- sum_Ranking_AI / 15
for (i in 1:15) {
sum_Ranking_Human <- sum_Ranking_Human + df_total[[paste0("Ranking_Human", i)]]
}
df_total$Hum_MSG_Rank_mean <- sum_Ranking_Human / 15
# Mixed ANOVA
colnames()
# Mixed ANOVA
colnames(df_total)
df_total_AI_3EPs <- df_total[c(1:2, 157:171, 173:187)]
df_total_AI_3EPs_pivot <- df_total_AI_3EPs |>
pivot_longer(!c(Experimental_Group, Participant), names_to="Messages",
values_to="Effects_Perception") |>
mutate(AI_or_Hum = ifelse(grepl("^AI", Messages), "AI", "Human"))
df_total_AI_3EPs_pivot$AI_or_Hum <- as.factor(df_total_AI_3EPs_pivot$AI_or_Hum)
df_total_AI_3EPs_pivot$AI_or_Hum <- relevel(df_total_AI_3EPs_pivot$AI_or_Hum, ref = "AI")
df_total_AI_3EPs_pivot$Participant <- as.factor(df_total_AI_3EPs_pivot$Participant)
df_total_AI_3EPs_pivot$Experimental_Group <- as.factor(df_total_AI_3EPs_pivot$Experimental_Group)
df_total_AI_3EPs_pivot$Experimental_Group <- relevel(df_total_AI_3EPs_pivot$Experimental_Group, ref = "Not Disclosed")
ez::ezANOVA(
data = df_total_AI_3EPs_pivot,
wid = .(Participant),
within = .(AI_or_Hum),
between = .(Experimental_Group),
dv = .(Effects_Perception),
type = 3
)
##Data visualization
means_CI <-
df_total_AI_3EPs_pivot %>%
group_by(Experimental_Group, AI_or_Hum) %>%
get_summary_stats(Effects_Perception, type = "mean_ci") %>%
mutate(
lower_CI = mean - ci,
upper_CI = mean + ci
)
##Post-hoc t-tests
means <-
df_total_AI_3EPs_pivot %>%
group_by(Experimental_Group, AI_or_Hum) %>%
get_summary_stats(Effects_Perception, type = "mean_sd")
df_total_AI_3EPs_pivot_AI <- df_total_AI_3EPs_pivot %>% filter(AI_or_Hum == "AI")
df_total_AI_3EPs_pivot_Hum <- df_total_AI_3EPs_pivot %>% filter(AI_or_Hum == "Human")
t.test(Effects_Perception ~ Experimental_Group, data = df_total_AI_3EPs_pivot_AI)
t.test(Effects_Perception ~ Experimental_Group, data = df_total_AI_3EPs_pivot_Hum)
means
#Wilcoxon Rank Sum Analysis
df_total_KrusWall <- df_total[c("Experimental_Group", "Participant", "AI_MSG_Rank_mean", "Hum_MSG_Rank_mean")]
df_total_KrusWall_pivot <- df_total_KrusWall |> pivot_longer(!c(Experimental_Group, Participant), names_to="AI_or_Hum", values_to="Rank")
df_total_KrusWall_pivot$Experimental_Group <- factor(df_total_KrusWall_pivot$Experimental_Group, levels = c("Not Disclosed", "Disclosed"))
df_total_KrusWall$rankdiff <- df_total_KrusWall$AI_MSG_Rank_mean - df_total_KrusWall$Hum_MSG_Rank_mean
group_by(df_total_KrusWall, Experimental_Group) %>%
dplyr::summarise(
count = n(),
mean = mean(rankdiff, na.rm = TRUE),
sd = sd(rankdiff, na.rm = TRUE),
median = median(rankdiff, na.rm = TRUE),
IQR = IQR(rankdiff, na.rm = TRUE)
)
wilcox.test(rankdiff ~ Experimental_Group, data = df_total_KrusWall, exact=FALSE)
##Data visualization
df_total_KrusWall_pivot |>
ggplot(aes(x=AI_or_Hum, y=Rank, fill = AI_or_Hum)) +
geom_boxplot() +
theme(
plot.title = element_text(size=15,hjust=0.5),
axis.title.y=element_text(size=11,hjust=0.5)
) +
xlab("") +
ylim(0,25) +
labs(fill = "Source", y= "Preference Rank (1 = Best, 30 = Worse)") +
scale_x_discrete(labels=c(AI_MSG_Rank_mean = "AI", Hum_MSG_Rank_mean = "Human")) +
facet_wrap(~Experimental_Group) +
scale_fill_manual(values = c("AI_MSG_Rank_mean" = "steelblue", "Hum_MSG_Rank_mean" = "darkgreen")) +
theme_bw() +
theme(legend.position = "none")
# Mixed ANOVA
colnames(df_total)
df_total_AI_3EPs <- df_total[c(1:2, 172, 188)]
df_total_AI_3EPs_pivot <- df_total_AI_3EPs |>
pivot_longer(!c(Experimental_Group, Participant), names_to="Messages",
values_to="Effects_Perception") |>
mutate(AI_or_Hum = ifelse(grepl("^AI", Messages), "AI", "Human"))
df_total_AI_3EPs_pivot$AI_or_Hum <- as.factor(df_total_AI_3EPs_pivot$AI_or_Hum)
df_total_AI_3EPs_pivot$AI_or_Hum <- relevel(df_total_AI_3EPs_pivot$AI_or_Hum, ref = "AI")
df_total_AI_3EPs_pivot$Participant <- as.factor(df_total_AI_3EPs_pivot$Participant)
df_total_AI_3EPs_pivot$Experimental_Group <- as.factor(df_total_AI_3EPs_pivot$Experimental_Group)
df_total_AI_3EPs_pivot$Experimental_Group <- relevel(df_total_AI_3EPs_pivot$Experimental_Group, ref = "Not Disclosed")
ez::ezANOVA(
data = df_total_AI_3EPs_pivot,
wid = .(Participant),
within = .(AI_or_Hum),
between = .(Experimental_Group),
dv = .(Effects_Perception),
type = 3
)
df_total_AI_3EPs
df_total_AI_3EPs_pivot <- df_total_AI_3EPs |>
pivot_longer(!c(Experimental_Group, Participant), names_to="Messages",
values_to="Effects_Perception") |>
mutate(AI_or_Hum = ifelse(grepl("^AI", Messages), "AI", "Human"))
df_total_AI_3EPs_pivot$AI_or_Hum <- as.factor(df_total_AI_3EPs_pivot$AI_or_Hum)
df_total_AI_3EPs_pivot$AI_or_Hum <- relevel(df_total_AI_3EPs_pivot$AI_or_Hum, ref = "AI")
df_total_AI_3EPs_pivot$Participant <- as.factor(df_total_AI_3EPs_pivot$Participant)
df_total_AI_3EPs_pivot$Experimental_Group <- as.factor(df_total_AI_3EPs_pivot$Experimental_Group)
df_total_AI_3EPs_pivot$Experimental_Group <- relevel(df_total_AI_3EPs_pivot$Experimental_Group, ref = "Not Disclosed")
ez::ezANOVA(
data = df_total_AI_3EPs_pivot,
wid = .(Participant),
within = .(AI_or_Hum),
between = .(Experimental_Group),
dv = .(Effects_Perception),
type = 3
)
##Data visualization
means_CI <-
df_total_AI_3EPs_pivot %>%
group_by(Experimental_Group, AI_or_Hum) %>%
get_summary_stats(Effects_Perception, type = "mean_ci") %>%
mutate(
lower_CI = mean - ci,
upper_CI = mean + ci
)
means_CI
ggplot(means_CI, aes(x = AI_or_Hum, y = mean)) +
geom_line(aes(group = Experimental_Group), position = position_dodge(0.9), color="dimgray") +
geom_point(aes(color = AI_or_Hum), position = position_dodge(0.9)) +
geom_errorbar(
aes(ymin = lower_CI, ymax = upper_CI, color = AI_or_Hum),
width = 0.2,
position = position_dodge(0.9)
) +
theme(plot.title = element_text(hjust = 0.5)) +
facet_wrap(~Experimental_Group) +
ylim(3,5) +
labs(y = "Effects Perception",
x = "Message Source") +
theme_bw() +
scale_color_manual(values = c("AI" = "steelblue", "Human" = "darkgreen")) +
theme(legend.position = "none")
##Post-hoc t-tests
means <-
df_total_AI_3EPs_pivot %>%
group_by(Experimental_Group, AI_or_Hum) %>%
get_summary_stats(Effects_Perception, type = "mean_sd")
means
df_total_AI_3EPs_pivot_AI <- df_total_AI_3EPs_pivot %>% filter(AI_or_Hum == "AI")
df_total_AI_3EPs_pivot_AI
df_total_AI_3EPs_pivot_Hum <- df_total_AI_3EPs_pivot %>% filter(AI_or_Hum == "Human")
t.test(Effects_Perception ~ Experimental_Group, data = df_total_AI_3EPs_pivot_AI)
t.test(Effects_Perception ~ Experimental_Group, data = df_total_AI_3EPs_pivot_Hum)
t.test(Effects_Perception ~ Experimental_Group, data = df_total_AI_3EPs_pivot_AI)
t.test(Effects_Perception ~ Experimental_Group, data = df_total_AI_3EPs_pivot_Hum)
ez::ezANOVA(
data = df_total_AI_3EPs_pivot,
wid = .(Participant),
within = .(AI_or_Hum),
between = .(Experimental_Group),
dv = .(Effects_Perception),
type = 3
)
df_total_AI_3EPs_pivot
df_total_AI_3EPs_pivot_AI <- df_total_AI_3EPs_pivot %>% filter(AI_or_Hum == "AI")
df_total_AI_3EPs_pivot_Hum <- df_total_AI_3EPs_pivot %>% filter(AI_or_Hum == "Human")
df_total_AI_3EPs_pivot_ND <- df_total_AI_3EPs_pivot %>% filter(Experimental_Group == "Not Disclosed")
df_total_AI_3EPs_pivot_Dis <- df_total_AI_3EPs_pivot %>% filter(Experimental_Group == "Disclosed")
t.test(Effects_Perception ~ Experimental_Group, data = df_total_AI_3EPs_pivot_AI)
t.test(Effects_Perception ~ Experimental_Group, data = df_total_AI_3EPs_pivot_Hum)
t.test(Effects_Perception ~ Experimental_Group, data = df_total_AI_3EPs_pivot_ND)
t.test(Effects_Perception ~ AI_or_Hum, data = df_total_AI_3EPs_pivot_ND)
t.test(Effects_Perception ~ AI_or_Hum, data = df_total_AI_3EPs_pivot_Dis)
anova <- ez::ezANOVA(
data = df_total_AI_3EPs_pivot,
wid = .(Participant),
within = .(AI_or_Hum),
between = .(Experimental_Group),
dv = .(Effects_Perception),
type = 3
)
anova
TukeyHSD(anova)
library(TukeyHSD)
library(stats)
TukeyHSD(anova)
ez::ezANOVA(
data = df_total_AI_3EPs_pivot,
wid = .(Participant),
within = .(AI_or_Hum),
between = .(Experimental_Group),
dv = .(Effects_Perception),
type = 3
)
anova <- ez::ezANOVA(
data = df_total_AI_3EPs_pivot,
wid = .(Participant),
within = .(AI_or_Hum),
between = .(Experimental_Group),
dv = .(Effects_Perception),
type = 3
)
anova
anova <- ez::ezANOVA(
data = df_total_AI_3EPs_pivot,
wid = .(Participant),
within = .(AI_or_Hum),
between = .(Experimental_Group),
dv = .(Effects_Perception),
type = 3
)
emmeans(anova, pairwise~AI_or_Hum*Experimental_Group)
library(emmeans)
emmeans(anova, pairwise~AI_or_Hum*Experimental_Group)
anova
anova_result <- anova_result$ANOVA
anova_result <- anova$ANOVA
anova_result
emmeans(anova, pairwise~AI_or_Hum*Experimental_Group)
ez::ezANOVA(
data = df_total_AI_3EPs_pivot,
wid = .(Participant),
within = .(AI_or_Hum),
between = .(Experimental_Group),
dv = .(Effects_Perception),
type = 3
)
